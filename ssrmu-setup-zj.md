# 单端口多用户教程（魔改原版）

?> 注：「魔改原版」指 ss-panel-v3-mod，并非 SSPanel UIM。本文仅具有一定的参考意义。本文由 `ss-panel-v3-mod` 开发者编写，原文已经遗失，Wiki 仅做收录。

思来想去，还是来写写这个功能具体该怎么使用。

## 一.什么是单端口多用户

这个是很早之前就有人提出来的东西。基于不同历史时期的不同需求，再结合个人的一点小小的兴趣，就做了这么个功能。简单来说，就是能让你在单个端口上，承载你站点上所有用户的访问。也就是说原先是多端口，多用户，而现在所有用户就使用一个端口来进行通讯了。

## 二.功能演进以及发展

在今年八月份的时候，我个人的某个大事件之前，抽了一个晚上的时间，做了那么个功能。然后在之后很长的一段时间里，这个功能都长期处于残废状态，一来是没兴趣，二来是没需求。然后现在有点力气，就来搞搞。目前是可以稳定使用了，就打算写下此文来介绍一下。

## 三.操作前准备

请确认你已经安装好面板和后端，并且正确配置。

## 四.操作步骤

下面以添加一个 8080 端口号的单端口多用户承载端口为例。

1.首先请您自己在您的站点上注册一个新用户，此用户等级最好大于所有节点等级。

2.然后在管理员后台面板编辑一下用户。按照图上的指示编辑，然后保存。

2016年11月3日更新：自定义混淆方式可以并且推荐使用 tls1.2_ticket_auth .

![](https://i.imgur.com/A2wutS7.png)

3.然后添加一个节点。看图上的指示。

![](https://i.imgur.com/OmZXZ8F.png)

4.然后修改面板的 `config/.config.php`，确保里面如下两段 已经按照你的意愿设置并且和后端上 `userapiconfig.py` 里的对应配置项一致。

```php
#多用户混淆参数后缀
$System_Config['mu_suffix']='zhaoj.in';

#多用户混淆参数表达式，%5m代表取用户特征 md5 的前五位，%id 代表用户id,%suffix 代表上面这个后缀。
$System_Config['mu_regex']='%5m%id.%suffix';
```

对应后端上的：

```
MU_SUFFIX = 'zhaoj.in'
MU_REGEX = '%5m%id.%suffix'
```

5.添加完毕。

## 四.使用方法

看到面板里你之前添加的节点的 tab ，每个选项卡你点开都会看到多出来一个你刚才添加的端口，点进去，扫码什么的连接就好。

![](https://i.imgur.com/S4fu5KU.png)

祝使用愉快。